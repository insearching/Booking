var _i_=this._i_||function(){},_r_=this._r_||function(e){return e},_sp_=this._sp_||function(e){B.et.customGoal("cDPPESHbfNFVTAYZSQDZET",1),B.reportError({message:"SPDR function called - "+e},"SPDR")};B.define("component/referral/floater",function(e,i,a){_i_("44d:439cb7dd");var n=e("component"),t=e("ga-tracker");a.exports=n.extend({init:function(){_i_("44d:bdf88b61");var e=this;this.$toggle=this.$el.find(".friend_landing_collapsible--header"),this.$toggleIcon=this.$el.find(".friend_landing_collapsible--toggle_icon"),this.$collapse=this.$el.find(".friend_landing_collapsible-action_button"),this.isMobile=this.$el.data("is-mobile"),this.toggleCollapseClass=this.$el.data("expanded-class"),this.toggleExpandClass=this.$el.data("collapsed-class"),this.isCollapsed=!!this.$el.data("is-collapsed"),this.isCollapsedClass=this.$el.data("landing-collapsed-class"),this.collapsingDisabled=this.$el.data("collapsing-disabled"),this.collapsingDisabled||(this.$toggle.on("click",function(){_i_("44d:db6abdaa"),e.isCollapsed?e.expand():e.collapse(),_r_()}),this.$collapse.on("click",function(){_i_("44d:ca906f67"),e.collapse(),_r_()})),t.trackEvent(t.referralFriendTracker,"view","friend_landing"),this.$el.find(".friend_landing_collapsible-tandc").on("click",function(){_i_("44d:208b670a"),t.trackEvent(t.referralFriendTracker,"click","terms_and_conditions - source: friend_landing"),_r_()}),_r_()},collapse:function(){_i_("44d:5a14237e"),this.$el.addClass(this.isCollapsedClass),this.$toggleIcon.removeClass(this.toggleCollapseClass),this.$toggleIcon.addClass(this.toggleExpandClass),this.isCollapsed=!0,t.trackEvent(t.referralFriendTracker,"collapse","friend_landing"),_r_()},expand:function(){_i_("44d:9260a3a3"),this.$el.removeClass(this.isCollapsedClass),this.$toggleIcon.addClass(this.toggleCollapseClass),this.$toggleIcon.removeClass(this.toggleExpandClass),this.isCollapsed=!1,t.trackEvent(t.referralFriendTracker,"expand","friend_landing"),_r_()}}),_r_()}),B.define("referral/clipboard",function(e,i,a){_i_("44d:6dad79bc");var n=function(){};n.prototype.copy=function(e,i){_i_("44d:b9e312de"),this.text=e,this.isRTL=B.env.b_lang_rtl,"function"==typeof i&&(this.copyCallback=i),this.selectFake(),_r_()},n.prototype.selectFake=function(){_i_("44d:563ce6c9"),this.removeFake();var e=document.createElement("textarea");(this.fakeElement=e).style.fontSize="12pt",e.style.border="0",e.style.padding="0",e.style.margin="0",e.style.position="absolute",e.style[this.isRTL?"right":"left"]="-9999px";var i=window.pageYOffset||document.documentElement.scrollTop;e.style.top=i+"px",e.setAttribute("readonly",""),e.value=this.text,document.body.appendChild(e),function(e){var i;if(_i_("44d:eed13d9d"),"SELECT"===e.nodeName)e.focus(),i=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName){var a=e.hasAttribute("readonly");a||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),a||e.removeAttribute("readonly"),i=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var n=window.getSelection(),t=document.createRange();t.selectNodeContents(e),n.removeAllRanges(),n.addRange(t),i=n.toString()}_r_(i)}(e),this.copyText(),_r_()},n.prototype.removeFake=function(){_i_("44d:dcba3dac"),this.fakeElement&&(document.body.removeChild(this.fakeElement),this.fakeElement=null),_r_()},n.prototype.copyText=function(){var i;_i_("44d:881b30ae");try{i=document.execCommand("copy")}catch(e){i=!1}this.handleResult(i),_r_()},n.prototype.handleResult=function(e){_i_("44d:14c14746"),this.copyCallback&&(e?this.copyCallback(null):this.copyCallback(!0)),this.removeFake(),_r_()},a.exports=new n,_r_()}),B.define("component/referral/share",function(e,i,a){_i_("44d:8a1a989c");var _=e("ga-tracker"),r=e("tooltip"),o=e("referral/clipboard"),n=e("referral/raf-goal"),t=e("referral/rap-goal");a.exports=e("component").extend({init:function(){_i_("44d:e4616695");var n=this,i=this.$el.data("share-link"),t=this.$el.data("tooltip-id")||"clipboard-tooltip";this.isPartnerProgram=this.$el.is("[data-is-partner-program]"),this.isShowCompliment=this.$el.is("[data-show-compliment]"),this.$emailShare=this.$el.find(".js-raf-share-email"),this.$emailShare.on("click",function(){_i_("44d:1c8d4064"),n.triggerGoal("share_email",this.isPartnerProgram?"click email mobile button":"click email button"),_r_()}),this.$gmailShare=this.$el.find(".js-raf-share-gmail"),this.$gmailShare.on("click",function(){_i_("44d:1b612da0"),n.triggerGoal("share_gmail","click gmail button"),_r_()}),this.$fbShare=this.$el.find(".js-raf-share-facebook"),this.$fbShare.on("click",function(e){_i_("44d:061c0e26"),e.preventDefault(),n.showPopupWindow($(this).attr("href"),"Share",480,320),n.triggerGoal("share_facebook","click facebook button"),_r_()}),this.$twShare=this.$el.find(".js-raf-share-twitter"),this.$twShare.on("click",function(e){_i_("44d:0b0d8550"),e.preventDefault(),n.triggerGoal("share_twitter","click twitter button"),n.showPopupWindow($(this).attr("href"),"Share",480,320),_r_()}),this.$el.find(".raf-scoreboard--link").on("click",function(i){_i_("44d:2f7ad4a8");var e=$(this).val();o.copy(e,function(e){if(_i_("44d:bce39a05"),e)return _r_(!1);n.triggerGoal("share_copy"),n.$urlShare.text(n.$urlShare.data("success-copy")),i.target.select(),_r_()}),_r_()}),this.$el.find(".raf-scoreboard--link").on("copy",function(){_i_("44d:4b58d24c"),_.trackEvent(_.referralAdvocateTracker,"copy link","myreferrals"),_r_()}),this.$urlShare=this.$el.find(".js-raf-share-copy"),this.$urlShare.on("click",function(e){_i_("44d:da57e023");var i=n.$urlShare.data("share-link"),a=r.get(t);e.preventDefault(),o.copy(i,function(e){if(_i_("44d:038f8483"),e)return _r_(!1);n.triggerGoal("share_copy"),a?(a.show(),setTimeout(function(){var e;_i_("44d:d5add9e4"),e=a,_i_("44d:73af4510"),e&&e.hide&&e.hide(),_r_(),_r_()},1e3)):n.$urlShare.text(n.$urlShare.data("success-copy")),_r_()}),_.trackEvent(_.referralAdvocateTracker,"share - source: "+B.env.b_action,"click url button"),_r_()}),this.$whatsappShare=this.$el.find(".js-raf-share-whatsapp"),this.$whatsappShare.on("click",function(){_i_("44d:364e4520"),n.triggerGoal("share_whatsapp","click whatsapp button"),_r_()}),this.$linkedinShare=this.$el.find(".js-raf-share-linkedin"),this.$linkedinShare.on("click",function(){_i_("44d:ba038609"),n.triggerGoal("share_linkedin","click linkedin button"),_r_()}),this.$messengerShare=this.$el.find(".raf_scoreboard--social_share_link.-messenger, .js-raf-share-messenger"),this.$messengerShare.on("click",function(e){_i_("44d:04de4611"),n.triggerGoal("share_messenger","click messenger button"),"undefined"!=typeof FB&&void 0!==FB.ui&&(e.preventDefault(),i||(i=$(this).data("share-link")),FB.ui({method:"send",link:i})),_r_()}),_r_()},showPopupWindow:function(e,i,a,n){_i_("44d:9957ea84");var t=window.screen.width/2-a/2,_=window.screen.height/2-n/2;return _r_(window.open(e,i,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+a+", height="+n+", top="+_+", left="+t))},triggerGoal:function(e,i){_i_("44d:201f4c6e"),this.isPartnerProgram?t.shareGoal(e):n.shareGoal("gm_"+e),i&&_.trackEvent(this.isPartnerProgram?_.referralPartnerAdvocateTracker:_.referralAdvocateTracker,"share - source: "+B.env.b_action,i),_r_()}}),_r_()}),B.define("component/referral/friend-landing-modal",function(e,i,a){_i_("44d:c5ae498e");var n,t=e("component"),_=e("lightbox"),r=e("ga-tracker"),o=e("jquery"),s=B.env,d=e("browser-storage-handler"),c=e("events"),l=e("jstmpl"),f=!1,p=e("component/referral/name-reward-copy-logic/dynamic-tag-copy-logic"),u="raf_landing_modal_opened";"www"===s.b_site_type&&"index"===s.b_action&&(n=e("ultrafocus").getInstance("raf_landing","[data-sb-outer],[data-raf-widget]")),booking.jstmpl("friend_landing_card",function(){_i_("44d:d4894685");var _,r=["\n        ","\n    ","\n\n\n",'\n    <div\n        class="warn-message ','"\n        data-component="referral/warning-message"\n    >\n        <div class="warn-message__dismiss js-warning-message-dismiss">\n            ',"17","iconset/close","\n        </div>\n        ",'\n            <div class="warn-message__head">\n                <div class="warn-message__head-text">\n                        ',"20","iconset/warning","\n                    ","\n                </div>\n            </div>\n        ",'\n        <div class="warn-message__body">\n            ',"\n        </div>\n    </div>\n","\n",'\n<div class="raf-friend-landing-card">\n    <div class="raf-friend-landing-card__content">\n        <div class="raf-friend-landing-card__title">\n            ',"\n                ","\n            ","/private/raf_friend_lightbox_title/name",'\n        </div>\n\n        <div class="raf-friend-landing-card__subtitle">\n            ',"/private/raf_friend_lightbox_subtitle/name","/private/raf_friend_lightbox_subtitle_noname/name",'\n        </div>\n\n        <hr class="raf-friend-landing-card__divisor">\n\n        ',"/private/raf_friend_lightbox_step_1_description/name","/private/raf_friend_lightbox_step_2_description/name","/private/raf_friend_lightbox_step_3_description/name","\n\n        ","\n            \n            ",'\n\n        <div class="raf-friend-landing-card__steps">\n            <div class="raf-friend-landing-card__step">\n                <div class="raf-friend-landing-card__step-number">\n                    1\n                </div>\n                <p>','</p>\n                <img src="','" class="raf-friend-landing-card__step-image image__gift-heart" alt="">\n            </div>\n            <div class="raf-friend-landing-card__step">\n                <div class="raf-friend-landing-card__step-number">\n                    2\n                </div>\n                <p>','</p>\n                \n                <img src="','" class="raf-friend-landing-card__step-image image__booking-property" alt="">\n            </div>\n            <div class="raf-friend-landing-card__step">\n                <div class="raf-friend-landing-card__step-number">\n                    3\n                </div>\n                <p>','" class="raf-friend-landing-card__step-image image__wallet-gift" alt="">\n            </div>\n        </div>\n\n        ','\n            <div class="raf-min-spend-message">\n                ',"\n            </div>\n        ",'\n        <div class="raf-friend-landing-card__action">\n            ','\n                <a class="raf-friend-landing-card__button" href="','">\n                    ',"/private/raf_flex_modal_button_signin_register/name","\n                </a>\n            ",'\n                        <a class="raf-friend-landing-card__button" href="','">',"/private/raf_deals_easter19_cta/name","</a>\n                    ",'\n                        <a class="raf-friend-landing-card__button js-close-friend-landing-lightbox" href="#">\n                            ',"/private/raf_flex_post_signin_modal_button/name","\n                        </a>\n                    ",'\n                    <a class="raf-friend-landing-card__button js-close-friend-landing-lightbox" href="',"#",'">\n                        ',"/private/raf_friend_lightbox_button_text/name","\n                    </a>\n                ","\n        </div>\n    </div>\n</div>\n"],o=["fe_warning_message_extra_classes","fe_warning_message_header","fe_warning_message_body","fe_self_referral","fe_trans_raf_friend_lightbox_heading_signedin","fe_is_raf_campaign","b_user_auth_level_is_low_or_high","fe_trans_raf_friend_lightbox_heading","reward_value","fe_trans_raf_friend_lightbox_subtitle_deals","fe_show_deals","fe_trans_raf_friend_lightbox_subtitle_signedin","advocate_name","fe_raf_friend_lightbox_step_1_description_translated","fe_raf_friend_lightbox_step_2_description_translated","fe_raf_friend_lightbox_step_3_description_translated","fe_trans_raf_friendlanding_index_lightbox_step3_description","fe_raf_desktop_friend_landing_banner_minimum_spend","b_site_type","fe_login_page_accounts_portal_url","fe_deals_url","b_url_for_raf_flow","b_has_raf_link_saved_in_account"];return _r_(function(e){_i_("44d:c8d9dba6");var i,a,n="",t=this.fn;return n+=r[0],i=n,_i_("44d:1fc9000c"),t.MJ(t.MB(o[3]))&&(i+=r[1],e.unshift({fe_warning_message_body:t.MB(o[2]),fe_warning_message_header:t.MB(o[1])}),a=i,_i_("44d:ba45adec"),a+=[r[2],"",r[3],t.F.entities(t.MC(o[0])),r[4],(e.unshift({height:r[5],name:r[6],width:r[5]}),_=t.HELPER("icon",e[0]),e.shift(),_),r[7]].join(""),t.MD(o[1])&&(a+=[r[8],(e.unshift({color:"#E2AA11",height:r[9],name:r[10],width:r[9]}),_=t.HELPER("icon",e[0]),e.shift(),_),r[11],t.MC(o[1]),r[12]].join("")),a+=[r[13],t.MC(o[2]),r[14],"",r[15]].join(""),i=_r_(a),e.shift(),i+=r[15]),i+=r[16],t.MD(o[5])?(i+=r[17],t.MJ(t.MB(o[5]))&&t.MJ(t.MC(o[6]))?i+=[r[11],t.F.entities(t.MC(o[4])),r[17]].join(""):i+=[r[11],t.F.entities(t.MC(o[7])),r[17]].join(""),i+=r[18]):i+=[r[17],(e.unshift({value:t.MB(o[8])}),_=t.ME(r[19],t.MB,t.MN,null),e.shift(),_),r[18]].join(""),i+=r[20],t.MJ(t.MB(o[5]))&&t.MJ(t.MC(o[6]))?(i+=r[17],t.MD(o[10])?i+=[r[11],t.F.entities(t.MC(o[9])),r[17]].join(""):i+=[r[11],t.F.entities(t.MC(o[11])),r[17]].join("")):(i+=r[17],t.MD(o[12])?i+=[r[11],(e.unshift({friend_name:t.MB(o[12])}),_=t.ME(r[21],t.MB,t.MN,null),e.shift(),_),r[17]].join(""):i+=[r[11],t.ME(r[22],t.MB,t.MN,null),r[17]].join("")),i+=r[18],i+=r[23],t.MN(o[13],t.ME(r[24],t.MB,t.MN,null)),i+=r[0],t.MN(o[14],t.ME(r[25],t.MB,t.MN,null)),i+=r[0],t.MN(o[15],t.ME(r[26],t.MB,t.MN,null)),i+=r[27],t.MD(o[5])&&(i+=r[28],t.MN(o[13],t.ME(r[24],t.MB,t.MN,null)),i+=r[18],t.MN(o[14],t.ME(r[25],t.MB,t.MN,null)),i+=r[18],t.MN(o[15],t.F.entities(t.MC(o[16]))),i+=r[0]),i+=[r[29],t.MC(o[13]),r[30],t.STATIC_HOSTNAME("/static/img/referral/raf-gift-heart-decorated.svg",0,0,0),r[31],t.MC(o[14]),r[32],t.STATIC_HOSTNAME("/static/img/referral/raf-booking-property.svg",0,0,0),r[33],t.MC(o[15]),r[30],t.STATIC_HOSTNAME("/static/img/referral/raf-wallet-gift.svg",0,0,0),r[34]].join(""),t.MJ(t.MC(o[18])+""=="www")&&(i+=[r[35],t.MC(o[17]),r[36]].join("")),i+=r[37],t.MJ(t.MB(o[5]))&&t.MK(t.MC(o[6]))?i+=[r[38],t.F.entities(t.MC(o[19])),r[39],t.ME(r[40],t.MB,t.MN,null),r[41]].join(""):(i+=r[17],t.MJ(t.MB(o[5]))&&t.MJ(t.MC(o[6]))?(i+=r[11],t.MD(o[10])?i+=[r[42],t.F.entities(t.MC(o[20])),r[43],t.ME(r[44],t.MB,t.MN,null),r[45]].join(""):i+=[r[46],t.ME(r[47],t.MB,t.MN,null),r[48]].join(""),i+=r[17]):(i+=r[49],t.MD(o[22])?i+=t.F.entities(t.MC(o[21])):i+=r[50],i+=[r[51],t.ME(r[52],t.MB,t.MN,null),r[53]].join("")),i+=r[18]),i+=r[54],n=_r_(i),n+=r[1],_r_(n)})}());var m=function(){_i_("44d:b5e0eafd"),o(".raf-widget--hidden").removeClass("raf-widget--hidden"),_r_()};a.exports=t.extend({init:function(){_i_("44d:7f82f564"),c.on("raf-warning-hide",function(){_i_("44d:a146b57b"),_.rePosition(),_r_()}),this.doGaStuff(),this.bindExternalEvents();var e=this;window.setTimeout(function(){if(_i_("44d:7796f050"),e.shouldSkipLightbox())return m(),_r_();e.bindEvents(),e.renderLightbox(),_r_()},300),_r_()},bindExternalEvents:function(){_i_("44d:5c6748d9");var e=this;booking.eventEmitter.on("account-onboarding-modal-show",function(){_i_("44d:599b6801"),f=!0,_r_()}),c.on("onboarding-lightbox-dismissed",function(){_i_("44d:2afea17a"),f=!1,window.setTimeout(function(){_i_("44d:77a78e55"),_.isVisible()||e.init(),_r_()},100),_r_()}),_r_()},bindEvents:function(){var e;(_i_("44d:9f829f3f"),o("body").on("click",".js-close-friend-landing-lightbox",this.closeLightbox),void 0!==n)&&(n.on("ultrafocus::shown",function(){_i_("44d:c3af9a61"),o("#ss").focus(),e=window.setTimeout(function(){_i_("44d:68f0f3a9"),o("#raf-widget-text-container").addClass("expanded"),_r_()},3e3),_r_()}),n.on("ultrafocus::hidden",function(){_i_("44d:941125aa"),window.clearTimeout(e),_r_()}));_r_()},renderLightbox:function(){_i_("44d:0914cd39");var e=B.jstmpl("friend_landing_card"),i=s.b_secure_domain+"/myreferrals"+s.b_query_params_with_lang,a={reward_value:s.referral_data.reward_friend,reward_value_percentage:s.referral_data.reward_friend_percentage,advocate_name:s.referral_data.advocate_name,b_raf_li_in:s.b_raf_li_in,b_raf_prop_ne:s.b_raf_prop_ne,b_companyname:s.b_companyname,fe_faq_link:(s.b_secure_domain||s.b_secure_hostname)+"/content/referral-faq"+s.b_query_params_with_lang,fe_warning_message_header:l.translations("raf_self_landing_alert_index_headline"),fe_warning_message_body:"<p>"+l.translations("raf_self_landing_alert_index_subtext_1")+"</p><p><a target='_blank' href='"+i+"'>"+l.translations("raf_self_landing_alert_index_button_refer")+"</a></p>",fe_self_referral:!!s.referral_data.fe_self_referral,b_site_type:s.b_site_type,fe_raf_desktop_friend_landing_banner_minimum_spend:l.translations("raf_desktop_friend_landing_banner_minimum_spend",null,{minimum_spend:s.referral_data.b_raf_min_qualifying_amount_campaign_currency}),b_user_auth_level_is_none:s.b_user_auth_level_is_none,b_myreferral_link:s.referral_data.myreferral_link,fe_raf_marketing_validation:s.referral_data.fe_passed_raf_marketing_validation,b_raf_user_has_valid_booking:s.referral_data.b_raf_user_has_valid_booking,fe_is_raf_campaign:s.referral_data.is_raf_campaign,fe_trans_raf_friend_lightbox_heading:s.referral_data.is_raf_campaign?p.translate({fe_raf_campaign_details_fragment_output:s.referral_data.fe_raf_campaign_details,fe_raf_dynamic_copy_id:"raf_friendlanding_index_lightbox_headline",fe_raf_dynamic_copy_variable_campaign:!0,fe_raf_dynamic_copy_variable_reward:!0}):"",fe_trans_raf_friend_lightbox_heading_signedin:s.referral_data.is_raf_campaign?p.translate({fe_raf_campaign_details_fragment_output:s.referral_data.fe_raf_campaign_details,fe_raf_dynamic_copy_id:"raf_flex_post_signin_modal_headline",fe_raf_dynamic_copy_variable_name:!0}):"",fe_trans_raf_friend_lightbox_heading_instant_discount:s.referral_data.is_raf_campaign?p.translate({fe_raf_campaign_details_fragment_output:s.referral_data.fe_raf_campaign_details,fe_raf_dynamic_copy_id:"raf_instant_discount_flex_modal_headline",fe_raf_dynamic_copy_variable_campaign:!0}):"",fe_trans_raf_friend_lightbox_subtitle_instant_discount:s.referral_data.is_raf_campaign?p.translate({fe_raf_campaign_details_fragment_output:s.referral_data.fe_raf_campaign_details,fe_raf_dynamic_copy_variable_name:!0,fe_raf_dynamic_copy_id:"raf_instant_discount_flex_modal_subtext"}):"",fe_trans_raf_friend_lightbox_subtitle_signedin:s.referral_data.is_raf_campaign?p.translate({fe_raf_campaign_details_fragment_output:s.referral_data.fe_raf_campaign_details,fe_raf_dynamic_copy_id:"raf_flex_post_signin_modal_subtext",fe_raf_dynamic_copy_variable_campaign:!0,fe_raf_dynamic_copy_variable_reward:!0}):"",fe_trans_raf_friendlanding_index_lightbox_step3_description:s.referral_data.is_raf_campaign?p.translate({fe_raf_campaign_details_fragment_output:s.referral_data.fe_raf_campaign_details,fe_raf_dynamic_copy_id:"raf_friendlanding_index_lightbox_step3_description",fe_raf_dynamic_copy_variable_reward:!0}):"",fe_force_login:s.referral_data.rafForceLogin||0,b_user_auth_level_is_high:s.b_user_auth_level_is_high,b_user_auth_level_is_low_or_high:s.b_user_auth_level_is_low_or_high||+s.auth_level&&0<+s.auth_level,fe_show_deals:s.raf_show_deals,fe_deals_url:s.raf_show_deals?s.b_nonsecure_hostname+"/dealspage"+s.b_query_params_with_lang+s.b_query_params_delimiter+"campaign_id=easter_2019"+s.b_query_params_delimiter:"",fe_trans_raf_friend_lightbox_subtitle_deals:s.raf_show_deals?p.translate({fe_raf_campaign_details_fragment_output:s.referral_data.fe_raf_campaign_details,fe_raf_dynamic_copy_id:"raf_deals_easter19_subheader",fe_raf_dynamic_copy_variable_reward:!0}):"",fe_login_page_accounts_portal_url:B.env.fe_login_page_accounts_portal_url};_i_("44d:ada225d4"),o(".raf-widget, .raf-widget-text-container").addClass("raf-widget--hidden"),_r_();var n={autoWidth:!1,customWrapperClassName:"raf-friend-landing-card__lightbox-wrapper"+(2==s.referral_data.rafForceLogin?" raf-friend-landing-card__side-ui":""),customMaskClassName:"raf-friend-landing-card__lightbox-mask",positionAfterCallBack:function(){_i_("44d:f64ef655"),r.trackEvent(r.referralFriendTracker,"show","Friend Landing Lightbox"),_r_()},hideCallBack:function(){_i_("44d:2b257c9a"),B.env.referral_data.rafForceLogin||(r.trackEvent(r.referralFriendTracker,"dismiss","Friend Landing Lightbox"),d.addSessionValue(u,1)),m(),_r_()}};s.referral_data.rafForceLogin&&(n.bCloseButton=!1,n.bMaskClick=!1,n.closeOnEsc=!1);var t=_.show(e.render(a),n);t&&t.loadComponents&&t.loadComponents(),_r_()},closeLightbox:function(e){if(_i_("44d:4fe58a90"),e.preventDefault(),r.trackEvent(r.referralFriendTracker,"click","Friend Landing Lightbox"),!B.env.referral_data.rafForceLogin)if("www"==B.env.b_site_type||"tdot"==B.env.b_site_type){var i=o(".raf-friend-landing-card__lightbox-wrapper");s.rtl?i.css({bottom:i.css("bottom"),top:"auto"}).animate({left:"25px",bottom:"25px",width:"75px",height:"75px"},400,function(){_i_("44d:7eee0619"),_.hide(),_r_()}):i.css({right:i.css("right"),left:"auto",bottom:i.css("bottom"),top:"auto"}).animate({right:"25px",bottom:"25px",width:"75px",height:"75px"},400,function(){_i_("44d:7eee06191"),_.hide(),_r_()})}else _.hide();void 0===n||B.env.referral_data.rafForceLogin||n.show(),_r_()},shouldSkipLightbox:function(){return _i_("44d:a93e2ba9"),_r_(!B.env.b_is_landing&&d.getSessionValue(u)&&!s.b_raf_li_in&&!s.b_raf_prop_ne||s.referral_data.is_incentive_campaign||s.referral_data.b_has_raf_link_saved_in_account&&"89"==s.referral_data.raf_source||f)},switchView:function(e){_i_("44d:ccdef575");var i=o("#"+e).html();o(".raf-friend-landing-card__content").addClass("raf-sfl-view-wrapper").html(i),_.rePosition(),_r_()},saveForLater:function(){_i_("44d:342dc764"),o.ajax({url:s.b_secure_domain+"/saveforlateraccount",method:"POST",data:{save:1},success:function(e){_i_("44d:bc4f7f7f");var i=B.jstmpl("save_for_later_account_success");_.show(i.render({fe_index_url_no_raf:e.default_url,b_secure_hostname:s.b_secure_domain,b_query_params_with_lang:s.b_query_params_with_lang,b_query_params_delimiter:s.b_query_params_delimiter}),{bMaskClick:!1,bCloseButton:!1,customWrapperClassName:"sfla-success-modal-wrapper"}),_r_()},error:function(){},xhrFields:{withCredentials:!0}}),_r_()},doGaStuff:function(){if(_i_("44d:6846512c"),!s.referral_data||!s.referral_data.is_raf_campaign)return _r_();var e="RAF_LOGGED_OUT_LANDING";0<+s.auth_level&&d.getSessionValue(e)?(d.deleteSessionValue(e),r.trackEvent(r.webViralityTracker,"raf-login-success"),2==+s.auth_level&&s.referral_data.user_just_registered?r.trackEvent(r.webViralityTracker,"raf-login-success-created"):r.trackEvent(r.webViralityTracker,"raf-login-success-login")):0==+s.auth_level&&d.addSessionValue(e,1),_r_()}}),_r_()}),B.define("referral/raf-goal",function(e,i,a){_i_("44d:97b3ad3a");var n=e("et");a.exports={shareGoal:function(e){_i_("44d:53c28dcd"),n.goal(e),n.goal("gm_share"),_r_()}},_r_()}),B.define("referral/rap-goal",function(e,i,a){_i_("44d:2e0f5abd");var n=e("et");a.exports={shareGoal:function(e){_i_("44d:2cd92b4e"),n.goal("grap_share"),_r_()}},_r_()}),function(p){_i_("44d:a6bb0ba0");function u(e){_i_("44d:92f30a71"),p.reportError(new Error(e),"raf:copy-input"),_r_()}p.define("component/referral/copy-input",function(e,i,a){_i_("44d:09bb1fb1");var n=e("component"),c=e("referral/clipboard"),t=e("tooltip"),_=e("referral/raf-goal"),l=e("referral/rap-goal"),f=e("ga-tracker");a.exports=n.extend({init:function(){_i_("44d:2f039e91");var a=this,e=this.$el.find(".js-raf-copy-btn"),r=this.$el.find(".js-raf-copy-input"),i=this.$el.is("[data-is-partner-program]"),o=r.val();if(!r.get(0))return u("Share link node is missing"),_r_();if(!e.get(0))return u("Share btn node is missing"),_r_();if(!o)return u("RAF share links is missing"),_r_();function s(){_i_("44d:35202ca9");var e=a.$el.data("tooltip-id"),i=t.get(e);if(!i)return u('Tooltip with id "'+e+'" is missing'),_r_();i.show(),setTimeout(function(){_i_("44d:ce2c5886"),i.hide(),_r_()},1e3),_r_()}function d(){_i_("44d:43c5560b"),i?(f.trackEvent(f.referralPartnerAdvocateTracker,"share - source: "+p.env.b_action,"click copy"),l.shareGoal("share_copy")):_.shareGoal("gm_share_copy"),_r_()}e.add(r).on("click",function(e){if(_i_("44d:4a7ebd46"),e.preventDefault(),navigator.userAgent.match(/ipad|ipod|iphone/i)){var i=r.get(0),a=i.contentEditable,n=i.readOnly;i.contentEditable=!0,i.readOnly=!1;var t=document.createRange();t.selectNodeContents(i);var _=window.getSelection();_.removeAllRanges(),_.addRange(t),i.setSelectionRange(0,999999),i.contentEditable=a,i.readOnly=n,document.execCommand("copy"),r.blur(),s(),d()}else c.copy(o,function(e){if(_i_("44d:3fc4dc86"),r.select(),e)return _r_();s(),d(),_r_()}.bind(this));_r_()}),_r_()}}),_r_()}),_r_()}(window.B),B.define("component/referral/ribbon",function(e,i,a){_i_("44d:085955f7");var n=e("component"),t=e("jquery"),_=e("ga-tracker"),r=e("events"),o="index"===B.env.b_action;if(o)var s=e("ultrafocus").getInstance("raf_ribbon","[data-sb-outer]");var d="-collapsed";a.exports=n.extend({init:function(){_i_("44d:9648204f");var e=this;(this.searchInput=t("#ss"),this._onToggleClickBinded=this.onToggleClick.bind(this),this._onRibbonClickBinded=this.onRibbonClick.bind(this),this.$el.on("click",this._onRibbonClickBinded),this.$toggle=this.$el.find(".referral_ribbon--toggle"),this.$toggle.on("click",this._onToggleClickBinded),o)&&(s.on("ultrafocus::shown",function(){_i_("44d:f665ceda"),e.searchInput&&e.searchInput.focus(),_r_()}),B.require("search/searchbox/searchbox-sticky-controller").getController().on("show",function(){_i_("44d:ecb191ee"),s.hide(),_r_()}));this.$actionButton=this.$el.find(".referral_ribbon--button"),this.$actionButton.on("click",function(e){_i_("44d:8aaed789"),e.stopPropagation(),this.collapse(),o&&s.show(),_.trackEvent(_.referralFriendTracker,"click","start-searching button on ribbon"),_r_()}.bind(this)),this.$el.find(".referral_ribbon--terms a").on("click",function(){_i_("44d:37900131"),_.trackEvent(_.referralFriendTracker,"click","term_and_conditions - source: ribbon on"+B.env.b_action),_r_()}),r.on("incentives:campaignExpired",function(){_i_("44d:10d5b5fa"),this.$el.remove(),_r_()}.bind(this)),_r_()},onToggleClick:function(e){_i_("44d:d81ac054"),e.stopPropagation(),this.collapse(),_r_()},onRibbonClick:function(e){_i_("44d:88cd48cb"),this.$el.hasClass(d)&&(e.stopPropagation(),this.expand(),this.$el.off("click",this._onRibbonClickBinded),this.$toggle.on("click",this._onToggleClickBinded)),_r_()},collapse:function(){_i_("44d:1277b34c"),this.$el.addClass(d),this.$toggle.off("click",this._onToggleClickBinded),this.$el.on("click",this._onRibbonClickBinded),_.trackEvent(_.referralFriendTracker,"collapse","ribbon"),_r_()},expand:function(){_i_("44d:8865cd7b"),this.$el.removeClass(d),_.trackEvent(_.referralFriendTracker,"expand","ribbon"),_r_()}}),_r_()}),B.define("component/referral/ribbon-green",function(e,i,a){_i_("44d:1d8320f8");var n=e("ga-tracker");a.exports=e("component").extend({init:function(){_i_("44d:642d9e6e"),$(document.documentElement).addClass("raf-ribbon-presents"),this.$el.on("click",function(){_i_("44d:1ae5e5bf"),n.trackEvent(n.referralFriendTracker,"click","ribbon-green"),_r_()}.bind(this)),this.$el.on("mouseover",function(){_i_("44d:750d0fea"),n.trackEvent(n.referralFriendTracker,"hover","ribbon-green"),_r_()}.bind(this)),_r_()}}),_r_()}),B.define("component/referral/raf-widget",function(e,i,a){_i_("44d:4fedf566"),a.exports=e("component").extend({init:function(){_i_("44d:0d45f1fb");var e=$("#raf-widget-text-container"),i=this.$el,a=e.hasClass("expanded");i.on("click",function(){_i_("44d:de2eb1da"),e.toggleClass("expanded"),_r_()});var n=e.data("expandAfter");n&&0<+n&&!a&&window.setTimeout(function(){_i_("44d:ec766fba"),e.addClass("expanded"),_r_()},+n),_r_()}}),_r_()}),B.define("component/referral/name-reward-copy-logic/dynamic-tag-copy-logic",function(e,i,a){_i_("44d:2fa0ee21");var l=e("jstmpl");function f(e,i){if(_i_("44d:d4b0c3f9"),i)return _r_("employee");if(e.b_campaign_details.b_is_discount_campaign)return _r_("percent");return _r_("fixed")}function p(e,i){return _i_("44d:6886ec45"),_r_(i?e.b_campaign_details.b_raf_reward_type_friend:e.b_campaign_details.b_raf_reward_type_advocate)}function u(e){if(_i_("44d:46d2fa3b"),e.advocate_name)return _r_("name");return _r_("noname")}function m(e,i){_i_("44d:77edce6d");var a=null;return a=i?e.b_campaign_details.b_raf_reward_advocate:e.b_campaign_details.b_is_discount_campaign?e.b_campaign_details.b_raf_reward_friend_percentage:e.b_campaign_details.b_raf_reward_friend,_r_(a)}a.exports={translate:function(e){_i_("44d:272ee07a");var i=e.fe_raf_campaign_details_fragment_output,a=e.fe_raf_dynamic_copy_id,n=e.fe_raf_dynamic_copy_variable_campaign||!1,t=e.fe_raf_dynamic_copy_variable_reward||!1,_=e.fe_raf_dynamic_copy_variable_name||!1,r=e.fe_raf_is_advocate_copy||!1,o=null,s=null,d=null,c=null;if(n&&t&&_)return o=f(i,r),s=p(i,r),d=u(i),c=m(i,r),_r_(l.translations(a+"_"+o+"_"+s+"_"+d,c,{advocate_name:i.advocate_name,value_percent_friend:i&&i.b_campaign_details&&i.b_campaign_details.b_raf_reward_friend_percentage,value_friend:i&&i.b_campaign_details&&i.b_campaign_details.b_raf_reward_friend_with_currency,minimum_spend:i&&i.b_campaign_details&&i.b_campaign_details.b_raf_min_qualifying_amount_campaign_currency}));if(n&&t)return o=f(i,r),s=p(i,r),c=m(i,r),_r_(l.translations(a+"_"+o+"_"+s,c,{value_percent_friend:i&&i.b_campaign_details&&i.b_campaign_details.b_raf_reward_friend_percentage,value_friend:i&&i.b_campaign_details&&i.b_campaign_details.b_raf_reward_friend_with_currency,minimum_spend:i&&i.b_campaign_details&&i.b_campaign_details.b_raf_min_qualifying_amount_campaign_currency}));if(t&&_)return s=p(i,r),d=u(i),_r_((l.translations(a+"_"+s+"_"+d),{advocate_name:i.advocate_name,value_percent_friend:i&&i.b_campaign_details&&i.b_campaign_details.b_raf_reward_friend_percentage,value_friend:i&&i.b_campaign_details&&i.b_campaign_details.b_raf_reward_friend_with_currency,minimum_spend:i&&i.b_campaign_details&&i.b_campaign_details.b_raf_min_qualifying_amount_campaign_currency}));if(n&&_)return o=f(i,r),d=u(i),c=m(i,r),_r_(l.translations(a+"_"+o+"_"+d,c,{advocate_name:i.advocate_name}));if(n)return o=f(i,r),c=m(i,r),_r_(l.translations(a+"_"+o,c,{value_percent_friend:i&&i.b_campaign_details&&i.b_campaign_details.b_raf_reward_friend_percentage,value_friend:i&&i.b_campaign_details&&i.b_campaign_details.b_raf_reward_friend_with_currency}));if(t)return s=p(i,r),_r_(l.translations(a+"_"+s,null,{value_percent_friend:i&&i.b_campaign_details&&i.b_campaign_details.b_raf_reward_friend_percentage,value_friend:i&&i.b_campaign_details&&i.b_campaign_details.b_raf_reward_friend_with_currency,minimum_spend:i&&i.b_campaign_details&&i.b_campaign_details.b_raf_min_qualifying_amount_campaign_currency}));if(_)return d=u(i),_r_(l.translations(a+"_"+d,null,{advocate_name:i.advocate_name}));_r_()}},_r_()}),B.define("component/referral/require-login-lightbox",function(e,i,a){_i_("44d:9a29c119");var n=e("component");a.exports=n.extend({init:function(){_i_("44d:57a957ef"),B.command("show-auth-lightbox").run({tab:"register",extraClass:"uam-lighbox-force-login"}),_r_()}}),_r_()}),B.define("component/referral/invalid-link",function(e,i,a){_i_("44d:ca29cf9a");var n=e("component"),t=e("lightbox");booking.jstmpl("invalid_link_card",function(){_i_("44d:c2423b87");var t,_=["\n        ","\n",'\n    <div data-component="referral/require-login-lightbox"></div>\n','\n    <div class="raf_modal_invalid">\n        <div class="raf_modal_invalid__title">\n            ',"\n                ","/private/raf_friend_landing_shut_down_modal_body/name","\n            ","/private/raf_flex_shutdown_influencers/name",'\n        </div>\n        <div class="raf_modal_invalid_image">\n            <img width="150" src="','" alt="invalid raf">\n        </div>\n        <div class="raf_modal_invalid__subtitle">\n        </div>\n        <div class="raf_modal_invalid__body">\n        </div>\n        <div class="raf_modal_invalid_cta">\n            <button class="bui-button bui-button--primary js-modal-close" type="button" style="width: 100%">\n                <span class="bui-button__text">\n                    ',"/private/raf_validation_error_modal_employee_button/name",'\n                </span>\n            </button>\n        </div>\n        <button class="modal-mask-closeBtn" title="Close">\n            ',"iconset/close","large",'\n            <span class="invisible_spoken">Close</span>\n        </button>\n    </div>\n',"\n    "],r=["b_raf_error_code","b_raf_li_in","b_campaign_expired"];return _r_(function(e){_i_("44d:712e2d3c");var i,a="",n=this.fn;return a+=_[0],i=a,_i_("44d:c65d6cfb"),i+=_[1],n.MJ(n.MC(r[0])+""=="user_not_logged_in")?i+=_[2]:(i+=_[3],n.MJ(1==n.MC(r[1]))?i+=[_[4],n.ME(_[5],n.MB,n.MN,null),_[6]].join(""):n.MJ(1==n.MC(r[2]))&&(i+=[_[4],n.ME(_[7],n.MB,n.MN,null),_[6]].join("")),i+=[_[8],n.STATIC_HOSTNAME("/static/img/referral/raf-failure.svg",0,0,0),_[9],n.ME(_[10],n.MB,n.MN,null),_[11],(e.unshift({name:_[12],size:_[13]}),t=n.HELPER("icon",e[0]),e.shift(),t),_[14]].join("")),a=_r_(i),a+=_[15],_r_(a)})}()),a.exports=n.extend({init:function(){_i_("44d:df384cb0");var e=B.jstmpl("invalid_link_card"),i={b_raf_li_in:this.$el.data("raf-li-in"),b_campaign_expired:this.$el.data("campaign-expired"),fe_companyname:B.env.b_companyname},a=t.show(e.render(i),{bCloseButton:!1,customWrapperClassName:"raf_invalid_modal_wrapper"});a&&a.loadComponents&&a.loadComponents(),$(".js-modal-close").click(function(){_i_("44d:766c755e"),t.hide(),_r_()}),_r_()}}),_r_()}),B.define("rewards-ui/ga-tracking",function(e,i,a){_i_("44d:27cb0e07");var t=e("ga-tracker"),_=B.env.fe_is_incentives_ga_tracking_enabled,r=function(){_i_("44d:f18fd2ab");var e=B.env.b_action;if("index"===e)return _r_("Index");if("searchresults"===e)return _r_("SR");if("hotel"===e)return _r_("HP");if("book"===e){var i=B.env.b_book_stage;return _r_("BS"+i)}return _r_("confirmation"===e?"Conf":"UnknownPage")}();a.exports={trackEvent:function(e,i,a,n){if(_i_("44d:b2ff4ba6"),!_)return _r_();void 0===i&&(i=r),t.trackEvent(t.incentivesTracker,e,i,a,n),_r_()}},_r_()}),B.define("component/rewards-ui/ribbon",function(e,i,a){_i_("44d:0f3043a2");var n,t,_=e("component"),r=e("events"),o=e("rewards-ui/ga-tracking");"www"===B.env.b_site_type&&"index"===B.env.b_action&&(n=e("ultrafocus"))&&(t=n.getInstance("rewards-ribbon","[data-sb-outer]")),a.exports=_.extend({init:function(){_i_("44d:48b965e5"),this.initEvents(),_r_()},initEvents:function(){_i_("44d:27a35031"),this.$el.on("click",function(){_i_("44d:03058447"),this.$el.hasClass("-collapsed")&&this.toggleRibbon(),_r_()}.bind(this)),this.$el.find(".js-toggle").on("click",this.toggleRibbon.bind(this)),this.$el.find(".js-collapse").on("click",this.collapseRibbon.bind(this)),t&&t.on("ultrafocus::shown",function(){_i_("44d:a7983bf5"),$("#ss").focus(),_r_()}),"mdot"===B.env.b_site_type&&"hotel"===B.env.b_action&&B.eventNames&&(this.$el.after('<div id="js-rewards-ui-ribbon-placement"></div>'),r.on(B.eventNames.RT_ROOM_EXPAND,function(e){_i_("44d:fb49c190"),e.fullpage.$container.find(".js-rooms-page-loading").before(this.$el),_r_()}.bind(this)),r.on(B.eventNames.RT_ROOM_FOLD,function(){_i_("44d:6110acbb"),$("#js-rewards-ui-ribbon-placement").before(this.$el),_r_()}.bind(this))),_r_()},toggleRibbon:function(){return _i_("44d:90c52f87"),this.$el.toggleClass("-expanded -collapsed"),this.$el.hasClass("-expanded")&&this.trackExpanded(),_r_(!1)},collapseRibbon:function(){return _i_("44d:abe73d6f"),this.$el.removeClass("-expanded").addClass("-collapsed"),t&&t.show(),this.trackCollapsed(),_r_(!1)},trackExpanded:function(){_i_("44d:f5362c1e"),o.trackEvent("Ribbon-expand"),_r_()},trackCollapsed:function(){_i_("44d:5bbd7df3"),o.trackEvent("Ribbon-cta-click"),_r_()}}),_r_()}),B.define("component/rewards-ui/landing",function(e,i,a){_i_("44d:1ba8eb0f");var n,t,_=e("component"),r=e("dismiss-item"),o=window.BUI,s=e("jquery"),d=e("rewards-ui/ga-tracking");"www"===B.env.b_site_type&&"index"===B.env.b_action&&(n=e("ultrafocus"))&&(t=n.getInstance("rewards-landing","[data-sb-outer]")),a.exports=_.extend({init:function(){_i_("44d:937a73d9"),this.modal=o.createInstance("Modal",document.createElement("div"),{id:"rewards-landing",onAfterClose:function(){_i_("44d:796f1dac"),r("rewards_landing"),t&&t.show(),_r_()}}),t&&t.on("ultrafocus::shown",function(){_i_("44d:a7983bf51"),s("#ss").focus(),_r_()}),this.modal.mount(),this.modal.open(),this.initEvents(),_r_()},initEvents:function(){_i_("44d:2b31a0ae"),s(this.modal.modalEl).find(".js-main-cta").on("click",this.trackMainCta.bind(this)),_r_()},trackMainCta:function(){_i_("44d:96d27632"),d.trackEvent("Landing-cta-click"),_r_()}}),_r_()}),B.define("component/rewards-ui/offer-base",function(e,i,a){_i_("44d:420c82b7");var n=e("component"),t=e("jquery");a.exports=n.extend({rejectCampaign:function(){_i_("44d:47694e36"),t.ajax({url:(B.env.b_secure_domain||B.env.b_domain_for_book)+"/incentives/accept_or_reject_onsite",type:"post",data:{offer_status:"rejected"},xhrFields:{withCredentials:!0}}),_r_()},applyCampaign:function(){_i_("44d:b0185ff3"),this.onApplyStart(),this.hideError(),t.ajax({url:(B.env.b_secure_domain||B.env.b_domain_for_book)+"/incentives/accept_or_reject_onsite",type:"post",data:{offer_status:"accepted"},xhrFields:{withCredentials:!0},success:function(e){_i_("44d:ae48e12f"),e&&1===e.success?this.onApplySuccess(e):this.showError(),_r_()}.bind(this),error:function(){_i_("44d:b03990c0"),this.showError(),_r_()}.bind(this),complete:function(){_i_("44d:acfd7d10"),this.onApplyComplete(),_r_()}.bind(this)}),_r_()},initRibbon:function(){_i_("44d:14825841");var e=t("#rewards-ribbon").html();"mdot"===B.env.b_site_type?t(".tabbed-nav--content.tab-active").prepend(e):t("body").append(e),t(".rewards-ribbon").loadComponents(),window.BUI&&window.BUI.initComponents&&window.BUI.initComponents(t(".rewards-ribbon").get(0)),_r_()},onApplySuccess:function(){},onApplyStart:function(){},onApplyComplete:function(){},showError:function(){},hideError:function(){}}),_r_()}),B.define("component/rewards-ui/offer-modal",function(e,i,a){_i_("44d:cc7fa680");var n=e("component/rewards-ui/offer-base"),t=window.BUI,_=e("et"),r=e("jquery");a.exports=n.extend({init:function(){_i_("44d:017ecff8"),this.expHash=this.$el.data("hash"),this.modal=t.createInstance("Modal",document.createElement("div"),{id:"rewards-offer-modal",onAfterOpen:function(){_i_("44d:0f48f41b"),this.$modalRoot=r(this.modal.getModalRoot()),this.initEvents(),_r_()}.bind(this),onBeforeClose:function(){_i_("44d:94284826"),this.campaignApplied||this.rejectCampaign(),_r_()}.bind(this)}),this.modal.open(),_r_()},initEvents:function(){_i_("44d:ad293820"),this.$modalRoot.find(".js-reject").on("click",this.modal.close.bind(this.modal)),this.$modalRoot.find(".js-apply").on("click",this.applyCampaign.bind(this)),_r_()},rejectCampaign:function(){_i_("44d:3a1a79c8"),this.expHash&&_.customGoal(this.expHash,2),n.prototype.rejectCampaign.apply(this),_r_()},applyCampaign:function(){_i_("44d:0117da52"),this.expHash&&_.customGoal(this.expHash,1),n.prototype.applyCampaign.apply(this),_r_()},onApplySuccess:function(){_i_("44d:b9576e43"),this.campaignApplied=!0,this.modal.close(),this.initRibbon(),_r_()},onApplyStart:function(){_i_("44d:bb24459f"),this.$modalRoot.find(".js-apply").addClass("bui-is-loading"),_r_()},onApplyComplete:function(){_i_("44d:a9328f2a"),this.$modalRoot.find(".js-apply").removeClass("bui-is-loading"),_r_()},showError:function(){_i_("44d:a00bb60d"),this.$modalRoot.find(".rewards-offer-modal__error").removeClass("g-hidden"),_r_()},hideError:function(){_i_("44d:3c43d261"),this.$modalRoot.find(".rewards-offer-modal__error").addClass("g-hidden"),_r_()}}),_r_()}),B.define("component/rewards-ui/offer-ribbon",function(e,i,a){_i_("44d:620e87d6");var n=e("component/rewards-ui/offer-base"),t=e("et");a.exports=n.extend({init:function(){_i_("44d:b3e441b0"),this.expHash=this.$el.data("hash"),this.initEvents(),_r_()},initEvents:function(){_i_("44d:6b1a8c7c"),this.$el.find(".js-reject").on("click",this.rejectCampaign.bind(this)),this.$el.find(".js-apply").on("click",this.applyCampaign.bind(this)),_r_()},rejectCampaign:function(){_i_("44d:5bb74b82"),this.expHash&&t.customGoal(this.expHash,2),this.$el.remove(),n.prototype.rejectCampaign.apply(this),_r_()},applyCampaign:function(){_i_("44d:0117da521"),this.expHash&&t.customGoal(this.expHash,1),n.prototype.applyCampaign.apply(this),_r_()},onApplySuccess:function(){_i_("44d:632766b1"),this.$el.remove(),this.initRibbon(),_r_()},onApplyStart:function(){_i_("44d:f5da7e4e"),this.$el.find(".js-apply").addClass("bui-is-loading"),_r_()},onApplyComplete:function(){_i_("44d:3360c4ba"),this.$el.find(".js-apply").removeClass("bui-is-loading"),_r_()},showError:function(){_i_("44d:6781ab67"),this.$el.find(".rewards-offer-ribbon__error").removeClass("g-hidden"),_r_()},hideError:function(){_i_("44d:a0b5fc22"),this.$el.find(".rewards-offer-ribbon__error").addClass("g-hidden"),_r_()}}),_r_()}),B.define("component/rewards-ui/promo-banner",function(e,i,a){_i_("44d:1c1d13b3");var n=e("component"),t=e("dismiss-item"),_=window.BUI,r=e("referral/clipboard"),o=e("et"),s=e("jquery");a.exports=n.extend({init:function(){_i_("44d:699677b5"),this.code=this.$el.data("token"),this.code||this.getCouponCode();var e=this.$el.find(".js-more-info")[0];e&&(this.modal=_.getInstance(e),this.modal&&this.modal.props&&(this.modal.props.onAfterOpen=function(){_i_("44d:e84636ce"),this.$modalRoot=s(this.modal.getModalRoot()),this.$modalRoot.find(".js-copy").on("click",this.copyCode.bind(this)),this.code&&(this.$modalRoot.find(".js-code").text(this.code),this.$modalRoot.find(".js-copy").removeAttr("disabled")),_r_()}.bind(this),this.modal.props.onAfterClose=function(){_i_("44d:f5f1821c"),this.$modalRoot=null,_r_()}.bind(this))),this.initEvents(),this.$el.data("modal-auto-open")&&(this.modal.open(),t("rewards_promo_banner_modal_auto_open")),_r_()},getCouponCode:function(){_i_("44d:436448a9"),s.ajax({url:(B.env.b_secure_domain||B.env.b_domain_for_book)+"/incentives/get_owned_token_onsite",type:"get",xhrFields:{withCredentials:!0},success:function(e){_i_("44d:f2a3d1b8"),this.code=e.token,this.$el.find(".js-code").text(this.code),this.$el.find(".js-copy").removeAttr("disabled"),this.$modalRoot&&(this.$modalRoot.find(".js-code").text(this.code),this.$modalRoot.find(".js-copy").removeAttr("disabled")),_r_()}.bind(this),error:function(e){}.bind(this)}),_r_()},initEvents:function(){_i_("44d:d0e6f714"),this.$el.find(".js-copy").on("click",this.copyCode.bind(this)),_r_()},copyCode:function(e){_i_("44d:702585f7");var i=s(e.currentTarget),a=i.find(".js-copy-text");r.copy(this.code,function(e){if(_i_("44d:9dd55a92"),e)return _r_(!1);a.html(B.jstmpl.translations("convert_incentives_index_card_copy_cta_copied")),setTimeout(function(){_i_("44d:ebfc2955"),a.html(B.jstmpl.translations("convert_incentives_index_card_copy_cta")),_r_()},2e3),_r_()}),"banner"===i.data("placement")?(o.customGoal("fDeYAeaDUGTVZMYCXMXFUNYcHaDEUZC",1),o.customGoal("fDeYAeaDUGTVZMYCBJbCMALFIVZOFHe",1),o.customGoal("fDeYAeaDUGTMJRUKcbXDOXJKDKaT",1),o.customGoal("fDeYAeaDUGTMbYRabbHVJNLDOeHbC",1),o.customGoal("fDeYAeaDUGTBEUWHJEeeKET",1)):"modal"===i.data("placement")&&(o.customGoal("fDeYAeaDUGTVZMYCXMXFUNYcHaDEUZC",2),o.customGoal("fDeYAeaDUGTVZMYCBJbCMALFIVZOFHe",2),o.customGoal("fDeYAeaDUGTMJRUKcbXDOXJKDKaT",2),o.customGoal("fDeYAeaDUGTMbYRabbHVJNLDOeHbC",2),o.customGoal("fDeYAeaDUGTBEUWHJEeeKET",2)),_r_()}}),_r_()}),B.define("component/rewards-ui/bp-notice",function(e,i,a){_i_("44d:9cdd3195");var n=e("component"),t=e("events");a.exports=n.extend({init:function(){_i_("44d:5bb9e5f7"),1===this.$el.data("show-only-for-pay-later")&&t.on("payment:pay_online:changed",this.handlePayOnlineChanged.bind(this)),_r_()},handlePayOnlineChanged:function(e){_i_("44d:1b2ed250"),e?this.$el.fadeOut("slow"):this.$el.fadeIn("slow"),_r_()}}),_r_()}),B.define("component/rewards-ui/promo-code-storage",function(e,i,a){var n;_i_("44d:33ee5288");try{(n=window.localStorage).setItem("_t","_"),n.removeItem("_t")}catch(e){n=null}var t="rewardCouponCode";a.exports={setCoupon:function(e){_i_("44d:06d72f22"),n&&n.setItem(t,e),_r_()},getCoupon:function(){return _i_("44d:15e5148b"),_r_(n?n.getItem(t):null)},removeCoupon:function(){_i_("44d:ad56fcbe"),n&&n.removeItem(t),_r_()}},_r_()}),B.define("component/rewards-ui/promo-code-actions",function(e,i,a){_i_("44d:0f485bd9");var t=B.env.b_secure_domain||B.env.b_secure_hostname,_="get_active_reward",r="set_active_reward",n="clear_active_reward",o={};function s(e){return _i_("44d:ebdc2a74"),_r_("GOOGLENEST"===e||"GOOGLEMINI"===e||"TEST123MINI"===e)}function d(e,i){_i_("44d:1d579a6d");var a,n=t+"/reward/validate_coupon";B.env.s_raw_param_i_am_from&&2===B.env.s_raw_param_i_am_from.length&&(n+="?i_am_from="+B.env.s_raw_param_i_am_from),$.ajax({url:n,method:"POST",contentType:"application/json",data:JSON.stringify((a=e,_i_("44d:8c57fddc"),_r_({user_id:B.env.b_reg_user_id,booker_email:B.env.b_email||a.booker_email,user_language_code:B.env.fe_user_language_for_coupons,checkin_date:B.env.b_checkin_date_ymd,checkout_date:B.env.b_checkout_date_ymd,total_price:{amount:a.transaction_value,currency:B.env.fe_user_currency_code_for_coupons},coupon_code:a.reward_code}))),success:function(e){_i_("44d:6c755870"),i(e),_r_()},error:function(e){_i_("44d:0793e741"),i(null),_r_()},xhrFields:{withCredentials:!0}}),_r_()}o[_]="/incentives/get_active_reward",o[r]="/incentives/set_active_reward",o[n]="/incentives/clear_active_reward",a.exports={useNewFlow:s,onSubmit:function(i,e,a){if(_i_("44d:2cfeefd0"),i===r){if(void 0===e.reward_code&&(e.reward_code=""),!e.reward_code||e.reward_code.length<1)return a({success:0,message:{status:"E_NO_INCENTIVE_LINK"}},i),_r_();if(19===e.reward_code.length&&/^\d+$/.test(e.reward_code))return a({success:0,message:{status:"MAYBE_GIFT_CARD"}},i),_r_();if(s(e.reward_code))return d(e,a),_r_()}else e.reward_code=null;var n;$.ajax({url:t+(n=i,_i_("44d:24c78893"),_r_(o[n])),method:"POST",data:function(e,i){_i_("44d:68351a15");var a={user_id:B.env.b_reg_user_id,user_email:B.env.fe_email_for_coupons};return e!==r&&e!==_||(a.user_currency_code=B.env.fe_user_currency_code_for_coupons,a.user_language_code=B.env.fe_user_language_for_coupons,a.transaction_value=i.transaction_value,e===r&&(a.reward_code=i.reward_code)),_r_(a)}(i,e),success:function(e){_i_("44d:2ce2bd20"),a(e,i),_r_()},error:function(e){_i_("44d:f45a2269"),a(null,i),_r_()},xhrFields:{withCredentials:!0}}),_r_()},GET_ACTIVE_REWARD_COMMAND:_,SET_ACTIVE_REWARD_COMMAND:r,CLEAR_ACTIVE_REWARD_COMMAND:n,INSTANT_DISCOUNT_EVENT_CHANGED:"instant_discount:campaign_changed",REWARDS_COUPON_ADDED:"rewards_coupon:success",REWARDS_COUPON_REMOVED:"rewards_coupon:removed",REWARDS_COUPON_INVALID:"rewards_coupon:invalid"},_r_()}),B.define("component/rewards-ui/promo-code-templates",function(e,i){_i_("44d:893c5f4f"),booking.jstmpl("promo_card",function(){_i_("44d:481607a3");var t,_=["\n","\n\n\n",'\n\n<div class="promo-code-card ',"-error",' js-promo-code-card">\n\n    <div class="promo-code-card__main">\n\n        <img class="promo-code-card__image -valid" src="','" alt=""/>\n        <img class="promo-code-card__image -error" src="','" alt=""/>\n\n        <div class="promo-code-card__content">\n\n            <h3 class="promo-code-card__title">\n                ',"\n                    ","\n                        ","\n                            ","/private/www_promo_code_bs3_card_header_percent_paynow_paylater/name","/private/www_promo_code_bs3_card_header_percent_instant/name","/private/www_promo_code_bs3_card_header_percent_wc/name","/private/incentives_coupon_card_meets_spend_header_percent/name","\n                ","/private/www_promo_code_bs3_card_header_fixed_paynow_paylater/name","/private/www_promo_code_bs3_card_header_fixed_instant/name","/private/www_promo_code_bs3_card_header_fixed_wc/name","/private/incentives_coupon_card_meets_spend_header_fixed/name","\n            </h3>\n\n            ",'\n                    <div class="promo-code-card__code">\n                        ',"\n                    </div>\n                ","\n            ","\n\n            ",'\n                <p class="promo-code-card__message">\n                    ',"/private/www_promo_code_bs3_card_success_message_paynow_paylater/name","/private/www_promo_code_bs3_card_success_message_instant/name","/private/www_promo_code_bs3_card_success_message_wc/name","/private/www_promo_code_bs3_card_success_message_cc/name","\n                </p>\n            ",'\n\n            <div class="promo-code-card__conditions">\n                <div class="promo-code-card__condition">\n                    ',"iconset/calendar","small","/private/www_promo_code_bs3_card_condition_expiry/name","/private/incentives_coupon_card_no_expiration/name",'\n                </div>\n                <div class="promo-code-card__condition">\n                    ',"iconset/gift","/private/www_promo_code_bs3_card_condition_type_paynow_paylater/name","/private/www_promo_code_bs3_card_condition_type_instant/name","/private/www_promo_code_bs3_card_condition_type_wc/name","/private/www_promo_code_bs3_card_condition_type_cc/name",'\n                </div>\n            </div>\n\n            <div class="promo-code-card__actions">\n                <span class="bui-link bui-link--primary" data-bui-component="Popover" data-popover-content-id="promo-code-terms" data-popover-position="top" tabindex="0">\n                    ',"/private/www_promo_code_bs3_card_cta_more_info/name",'\n                </span>\n                <span class="bui-link bui-link--primary js-promo-code-card-remove" tabindex="0">\n                    ',"/private/www_promo_code_bs3_card_cta_remove/name",'\n                </span>\n            </div>\n        </div>\n    </div>\n\n    <div class="promo-code-card__error js-promo-code-card-error">\n        <div class="bui-alert bui-alert--error bui-alert--inline" role="status">\n            <span class="icon--hint bui-alert__icon" role="presentation">\n                ',"iconset/warning","presentation","24",'\n            </span>\n            <div class="bui-alert__description">\n                <p class="bui-alert__text">\n                    ',"/private/www_promo_code_bs3_error_min_spend/name","/private/www_promo_code_bs3_paynow_error/name",'\n                </p>\n            </div>\n        </div>\n    </div>\n\n    <div id="promo-code-terms" class="bui-panel bui-u-hidden promo-code-terms">\n        <h3>',"/private/www_promo_code_bs3_quick_tcs_header/name","</h3>\n        <ol>\n            <li>\n                ","/private/www_promo_code_bs3_quick_tcs_min_spend/name","\n            </li>\n            <li>\n                ","/private/www_promo_code_bs3_quick_tcs_type_paynow_paylater/name","/private/www_promo_code_bs3_quick_tcs_type_instant/name","/private/www_promo_code_bs3_quick_tcs_type_wc/name","/private/www_promo_code_bs3_quick_tcs_type_cc/name","\n            </li>\n            ","\n                <li>\n                    ","/private/www_promo_code_bs3_quick_tcs_action_wc/name","/private/www_promo_code_bs3_quick_tcs_action_cc/name","\n                </li>\n            ",'\n        </ol>\n        <p><a href="','" class="bui-link" target="_blank">',"/private/www_promo_code_bs3_quick_tcs_link_tcs/name",'</a></p>\n        <p><a href="',"/private/www_promo_code_bs3_quick_tcs_link_faq/name","</a></p>\n    </div>\n</div>\n"],r=["reward_item","fe_reward_types","fe_campaign_id","fe_reward_data","fe_is_wallet_campaign","terms_url","faq_url"];return _r_(function(e){_i_("44d:8d0d0f1a");var i,a="",n=this.fn;return i=a,_i_("44d:8eee0f31"),n.MN("fe_reward_data",n.MG((n.MC(r[0])||{}).data)),i+=_[0],n.MN("fe_reward_types",n.MG(((n.MC(r[0])||{}).data||{}).b_reward_types)),i+=_[0],n.MN("fe_campaign_id",n.MG(((n.MC(r[0])||{}).data||{}).b_campaign_id)),i+=_[1],n.MN("fe_is_wallet_campaign",n.MJ(n.MC(r[1]).pay_later+""=="wallet-credits")||n.MJ(/^(1000856|1001007|1001008|1001009|1001010|1001627)$/.test(n.MB(r[2])))),i+=_[2],n.MJ(n.MC(r[0]).status+""!="VALID")&&(i+=_[3]),i+=[_[4],n.STATIC_HOSTNAME("/static/img/incentives/promo_code/reward_graphic.png",0,0,0),_[5],n.STATIC_HOSTNAME("/static/img/incentives/promo_code/reward_graphic_inactive.png",0,0,0),_[6]].join(""),n.MJ(n.MG((n.MC(r[3])||{}).b_is_percentage_campaign))?(i+=_[7],n.MJ(n.MC(r[1]).pay_now+""=="instant-discount")?(i+=_[8],n.MJ(n.MC(r[1]).pay_later)?i+=[_[9],(e.unshift({reward_value:n.MG((n.MC(r[3])||{}).b_campaign_value)}),t=n.ME(_[10],n.MB,n.MN,null),e.shift(),t),_[8]].join(""):i+=[_[9],(e.unshift({reward_value:n.MG((n.MC(r[3])||{}).b_campaign_value)}),t=n.ME(_[11],n.MB,n.MN,null),e.shift(),t),_[8]].join(""),i+=_[7]):n.MJ(n.MB(r[4]))?i+=[_[8],(e.unshift({reward_value:n.MG((n.MC(r[3])||{}).b_campaign_value)}),t=n.ME(_[12],n.MB,n.MN,null),e.shift(),t),_[7]].join(""):n.MJ(n.MC(r[1]).pay_later+""=="cashback")&&(i+=[_[8],(e.unshift({reward_value:n.MG((n.MC(r[3])||{}).b_campaign_value)}),t=n.ME(_[13],n.MB,n.MN,null),e.shift(),t),_[7]].join(""))):(i+=_[7],n.MJ(n.MC(r[1]).pay_now+""=="instant-discount")?(i+=_[8],n.MJ(n.MC(r[1]).pay_later)?i+=[_[9],(e.unshift({reward_value:n.MG((n.MC(r[3])||{}).b_campaign_value)}),t=n.ME(_[15],n.MB,n.MN,null),e.shift(),t),_[8]].join(""):i+=[_[9],(e.unshift({reward_value:n.MG((n.MC(r[3])||{}).b_campaign_value)}),t=n.ME(_[16],n.MB,n.MN,null),e.shift(),t),_[8]].join(""),i+=_[7]):n.MJ(n.MB(r[4]))?i+=[_[8],(e.unshift({reward_value:n.MG((n.MC(r[3])||{}).b_campaign_value)}),t=n.ME(_[17],n.MB,n.MN,null),e.shift(),t),_[7]].join(""):n.MJ(n.MC(r[1]).pay_later+""=="cashback")&&(i+=[_[8],(e.unshift({reward_value:n.MG((n.MC(r[3])||{}).b_campaign_value)}),t=n.ME(_[18],n.MB,n.MN,null),e.shift(),t),_[7]].join(""))),i+=_[14],i+=_[19],n.MJ(n.MC(r[3]).b_reward_code)&&(i+=_[14],n.MJ(n.track_experiment("fDeYAeaIeKBIFOGacePOdVNeJMET"))&&(i+=[_[20],n.F.entities((n.MC(r[3])||{}).b_reward_code),_[21]].join("")),i+=_[14],n.MJ(n.track_experiment_stage("fDeYAeaIeKBIFOGacePOdVNeJMET",1)),i+=_[22]),i+=_[23],n.MJ(n.MC(r[3]).b_is_percentage_campaign)&&n.MJ(n.MC(r[0]).status+""=="VALID")&&(i+=_[24],n.MJ(n.MC(r[1]).pay_now+""=="instant-discount")?(i+=_[8],n.MJ(n.MC(r[1]).pay_later)?i+=[_[9],(e.unshift({actual_reward_value:n.MG((n.MC(r[3])||{}).b_approx_fixed_value)}),t=n.ME(_[25],n.MB,n.MN,null),e.shift(),t),_[8]].join(""):i+=[_[9],(e.unshift({actual_reward_value:n.MG((n.MC(r[3])||{}).b_approx_fixed_value)}),t=n.ME(_[26],n.MB,n.MN,null),e.shift(),t),_[8]].join(""),i+=_[7]):n.MJ(n.MB(r[4]))?i+=[_[8],(e.unshift({actual_reward_value:n.MG((n.MC(r[3])||{}).b_approx_fixed_value)}),t=n.ME(_[27],n.MB,n.MN,null),e.shift(),t),_[7]].join(""):n.MJ(n.MC(r[1]).pay_later+""=="cashback")&&(i+=[_[8],(e.unshift({actual_reward_value:n.MG((n.MC(r[3])||{}).b_approx_fixed_value)}),t=n.ME(_[28],n.MB,n.MN,null),e.shift(),t),_[7]].join("")),i+=_[29]),i+=[_[30],(e.unshift({color:"#707070",name:_[31],size:_[32]}),t=n.HELPER("icon",e[0]),e.shift(),t),_[7]].join(""),n.MJ(n.MG((n.MC(r[3])||{}).b_expires_on_formatted))?i+=[_[8],(e.unshift({date_with_year:n.MG((n.MC(r[3])||{}).b_expires_on_formatted)}),t=n.ME(_[33],n.MB,n.MN,null),e.shift(),t),_[7]].join(""):i+=[_[8],n.ME(_[34],n.MB,n.MN,null),_[7]].join(""),i+=[_[35],(e.unshift({color:"#707070",name:_[36],size:_[32]}),t=n.HELPER("icon",e[0]),e.shift(),t),_[7]].join(""),n.MJ(n.MC(r[1]).pay_now+""=="instant-discount")?(i+=_[8],n.MJ(n.MC(r[1]).pay_later)?i+=[_[9],n.ME(_[37],n.MB,n.MN,null),_[8]].join(""):i+=[_[9],n.ME(_[38],n.MB,n.MN,null),_[8]].join(""),i+=_[7]):n.MJ(n.MB(r[4]))?i+=[_[8],n.ME(_[39],n.MB,n.MN,null),_[7]].join(""):n.MJ(n.MC(r[1]).pay_later+""=="cashback")&&(i+=[_[8],n.ME(_[40],n.MB,n.MN,null),_[7]].join("")),i+=[_[41],n.ME(_[42],n.MB,n.MN,null),_[43],n.ME(_[44],n.MB,n.MN,null),_[45],(e.unshift({name:_[46],role:_[47],width:_[48]}),t=n.HELPER("icon",e[0]),e.shift(),t),_[49]].join(""),n.MJ(n.MC(r[0]).status+""=="NOT_MINIMUM_VALUE")?i+=[_[8],(e.unshift({min_spend_value:n.MG((n.MC(r[3])||{}).b_minimum)}),t=n.ME(_[50],n.MB,n.MN,null),e.shift(),t),_[7]].join(""):i+=[_[8],n.ME(_[51],n.MB,n.MN,null),_[7]].join(""),i+=[_[52],n.ME(_[53],n.MB,n.MN,null),_[54],(e.unshift({min_spend_value:n.MG((n.MC(r[3])||{}).b_minimum)}),t=n.ME(_[55],n.MB,n.MN,null),e.shift(),t),_[56]].join(""),n.MJ(n.MC(r[1]).pay_now+""=="instant-discount")?(i+=_[7],n.MJ(n.MC(r[1]).pay_later)?i+=[_[8],n.ME(_[57],n.MB,n.MN,null),_[7]].join(""):i+=[_[8],n.ME(_[58],n.MB,n.MN,null),_[7]].join(""),i+=_[14]):n.MJ(n.MB(r[4]))?i+=[_[7],n.ME(_[59],n.MB,n.MN,null),_[14]].join(""):n.MJ(n.MC(r[1]).pay_later+""=="cashback")&&(i+=[_[7],n.ME(_[60],n.MB,n.MN,null),_[14]].join("")),i+=_[61],n.MJ(n.MC(r[1]).pay_later)&&(i+=_[62],n.MJ(n.MB(r[4]))?i+=[_[8],n.ME(_[63],n.MB,n.MN,null),_[7]].join(""):n.MJ(n.MC(r[1]).pay_later+""=="cashback")&&(i+=[_[8],n.ME(_[64],n.MB,n.MN,null),_[7]].join("")),i+=_[65]),i+=[_[66],n.F.html(n.MC(r[5])),_[67],n.ME(_[68],n.MB,n.MN,null),_[69],n.F.html(n.MC(r[6])),_[67],n.ME(_[70],n.MB,n.MN,null),_[71]].join(""),a=_r_(i),_r_(a)})}()),booking.jstmpl("reward_invalid_message",function(){_i_("44d:5c2a79a6");var o,s=["\n    ","\n        ","/private/growth_marketing_fake_promo_code_error/name","<br/>\n        ",'<a class="bui-link" target="_blank" href="https://www.booking.com/giftcard.html">',"</a>","/private/incentives_coupon_card_error_giftcard/name","/private/www_promo_code_bs3_error_expired/name","/private/www_promo_code_bs3_error_unknown/name","/private/www_promo_code_bs3_error_invalid/name","/private/www_promo_code_bs3_error_already_used/name","/private/rewards_redeem_enter_email_first_error/name","\n",'\n        <ul class="promo-code-error">\n            ',"\n                <li>\n                    <span>\n                        ","24","iconset/info_sign","presentation","\n                    </span>\n                    <span>","</span>\n                </li>\n            ","\n        </ul>\n    ","/private/rewards_redeem_server_error/name","\n\n"],d=["gift_card_start_link","gift_card_end_link","reward_error"];return _r_(function(_){_i_("44d:9945b98f");var e="",r=this.fn;return e=function(e){if(_i_("44d:ba23a4e0"),r.MJ(r.MG((r.MC(d[2])||{}).status)))e+=s[0],r.MJ(r.MC(d[2]).status+""=="MAYBE_GIFT_CARD")?(e+=[s[1],r.ME(s[2],r.MB,r.MN,null),s[3]].join(""),r.MN(d[0],s[4]),e+=s[1],r.MN(d[1],s[5]),e+=[s[1],(_.unshift({end_link:r.MB(d[1]),start_link:r.MB(d[0])}),o=r.ME(s[6],r.MB,r.MN,null),_.shift(),o),s[0]].join("")):r.MJ(r.MC(d[2]).status+""=="E_EXPIRED_COUPON")?e+=[(_.unshift({numeric_date:r.MG(((r.MC(d[2])||{}).data||{}).expired_on)}),o=r.ME(s[7],r.MB,r.MN,null),_.shift(),o),s[0]].join(""):r.MJ(r.MC(d[2]).status+""=="E_UNKNOWN_USER")?e+=[r.ME(s[8],r.MB,r.MN,null),s[0]].join(""):r.MJ(r.MC(d[2]).status+""=="E_NO_INCENTIVE_LINK")?e+=[r.ME(s[9],r.MB,r.MN,null),s[0]].join(""):r.MJ(r.MC(d[2]).status+""=="E_NO_SHARE_LINK")?e+=[r.ME(s[9],r.MB,r.MN,null),s[0]].join(""):r.MJ(r.MC(d[2]).status+""=="E_NO_CAMPAIGN_DETAILS")?e+=[r.ME(s[8],r.MB,r.MN,null),s[0]].join(""):r.MJ(r.MC(d[2]).status+""=="E_USED_INCENTIVE_LINK")?e+=[r.ME(s[10],r.MB,r.MN,null),s[0]].join(""):r.MJ(r.MC(d[2]).status+""=="E_ALREADY_REDEEMED")?e+=[r.ME(s[10],r.MB,r.MN,null),s[0]].join(""):r.MJ(r.MC(d[2]).status+""=="E_UNKNOWN_ERROR")?e+=[r.ME(s[8],r.MB,r.MN,null),s[0]].join(""):r.MJ(r.MC(d[2]).status+""=="E_NETWORK_ERROR")?e+=[r.ME(s[8],r.MB,r.MN,null),s[0]].join(""):r.MJ(r.MC(d[2]).status+""=="E_EMAIL_MISSING")&&(e+=[r.ME(s[11],r.MB,r.MN,null),s[0]].join("")),e+=s[12];else{if(e+=s[0],r.MJ(r.MG((r.MC(d[2])||{}).reasons))){e+=s[13];var i=(r.MC(d[2])||{}).reasons||[];_.unshift({txt:null});for(var a,n=1,t=i.length;n<=t;n++)_[0].txt=a=i[n-1],e+=[s[14],(_.unshift({color:"#FF6C6C",height:s[15],name:s[16],role:s[17],width:s[15]}),o=r.HELPER("icon",_[0]),_.shift(),o),s[18],r.F.html(a),s[19]].join("");_.shift(),e+=s[20]}else e+=[s[1],r.ME(s[21],r.MB,r.MN,null),s[0]].join("");e+=s[12]}return e+=s[22],_r_(e)}(e),_r_(e)})}()),booking.jstmpl("coupon_card",function(){_i_("44d:35cc1f3a");var s,d=['\n\n<div class="promo-code-card ',"-error",' js-promo-code-card">\n\n    <div class="promo-code-card__main">\n\n        <img class="promo-code-card__image -valid" src="','" alt=""/>\n        <img class="promo-code-card__image -error" src="','" alt=""/>\n\n        <div class="promo-code-card__content">\n\n            <h3 class="promo-code-card__title">','</h3>\n            <p class="promo-code-card__message">','</p>\n\n            <div class="promo-code-card__actions">\n                <span class="bui-link bui-link--primary js-promo-code-card-more-info-cta"\n                    data-bui-component="Popover"\n                    data-popover-content-id="promo-code-terms"\n                    data-popover-position="top"\n                    tabindex="0">\n                    ',"/private/rewards_code_redeem_more_details/name",'\n                </span>\n                <span class="bui-link bui-link--primary js-promo-code-card-remove" tabindex="0">\n                    ',"/private/rewards_code_redeem_remove/name",'\n                </span>\n            </div>\n        </div>\n    </div>\n\n    <div class="promo-code-card__error js-promo-code-card-error">\n        ','\n            <div class="bui-alert bui-alert--error bui-alert--inline" role="status">\n                <span class="icon--hint bui-alert__icon" role="presentation">\n                    ',"iconset/warning","presentation","24",'\n                </span>\n                <div class="bui-alert__description">\n                    <p class="bui-alert__text">',"</p>\n                </div>\n            </div>\n        ",'\n    </div>\n\n    <div id="promo-code-terms" class="bui-panel bui-u-hidden promo-code-terms">\n        <h3>',"/private/www_promo_code_bs3_quick_tcs_header/name","</h3>\n        <ol>\n            ","\n                <li>","</li>\n            ",'\n        </ol>\n        <p><a href="','" class="bui-link" target="_blank">',"/private/rewards_more_details_ts_and_cs/name",'</a></p>\n        <p><a href="',"/private/rewards_more_details_faq/name","</a></p>\n    </div>\n</div>\n"],c=["reward_data","fe_reward_details"];return _r_(function(r){_i_("44d:485bb455");var e="",o=this.fn;return e=function(e){_i_("44d:d299d605"),o.MN("fe_reward_details",o.MG((o.MC(c[0])||{}).details)),e+=d[0],o.MJ(o.MG((o.MC(c[0])||{}).eligible))||(e+=d[1]),e+=[d[2],o.F.html((o.MC(c[1])||{}).image_url),d[3],o.STATIC_HOSTNAME("/static/img/coupon/inactive_code.png",0,0,0),d[4],o.F.html((o.MC(c[1])||{}).title),d[5],o.F.html((o.MC(c[1])||{}).text),d[6],o.ME(d[7],o.MB,o.MN,null),d[8],o.ME(d[9],o.MB,o.MN,null),d[10]].join("");var i,a=(o.MC(c[0])||{}).error_messages||[];r.unshift({txt:null});for(var n,t=1,_=a.length;t<=_;t++)r[0].txt=n=a[t-1],e+=[d[11],(r.unshift({name:d[12],role:d[13],width:d[14]}),s=o.HELPER("icon",r[0]),r.shift(),s),d[15],o.F.html(n),d[16]].join("");for(r.shift(),e+=[d[17],o.ME(d[18],o.MB,o.MN,null),d[19]].join(""),a=(o.MC(c[0])||{}).conditions||[],r.unshift({rule:null}),t=1,_=a.length;t<=_;t++)r[0].rule=i=a[t-1],e+=[d[20],o.F.html(i),d[21]].join("");return r.shift(),e+=[d[22],o.F.html((o.MC(c[1])||{}).terms_url),d[23],o.ME(d[24],o.MB,o.MN,null),d[25],o.F.html((o.MC(c[1])||{}).faq_url),d[23],o.ME(d[26],o.MB,o.MN,null),d[27]].join(""),_r_(e)}(e),_r_(e)})}()),_r_()}),B.define("component/rewards-ui/promo-code-base",function(e,i,a){_i_("44d:1d269fb8");var t=e("et"),n=e("component"),_=e("events"),r=e("component/rewards-ui/promo-code-storage"),o=e("component/rewards-ui/promo-code-actions"),s=e("rewards-ui/ga-tracking"),d=0;e("component/rewards-ui/promo-code-templates"),a.exports=n.extend({init:function(){_i_("44d:d823141c"),this.activeReward=null,this.initialized=!1,this.isFirstKeyStroke=!0,this.HIDE_CLASS="g-hidden",this.COUPON_INVALID_CLASS="bui-has-error",this.BUTTON_IS_LOADING_CLASS="bui-is-loading",this.REWARD_CARD_SELECTOR=".js-promo-code-card",this.REWARD_REMOVE_LINK_SELECTOR=".js-promo-code-card-remove",this.REWARD_MORE_INFO_LINK_SELECTOR=".js-promo-code-card-more-info-cta",this.$title=this.$el.find(".js-promo-code-title"),this.$msgList=this.$el.find(".js-promo-code-messages"),this.$replace=this.$el.find(".js-promo-code-replace"),this.$form=this.$el.find(".js-promo-code-form"),this.$input=this.$form.find(".js-promo-code-input"),this.$hiddenInput=this.$form.find(".js-coupon-code-input"),this.$error=this.$form.find(".js-promo-code-error"),this.$submit=this.$form.find(".js-promo-code-button"),this.$submitText=this.$submit.find(".bui-button__text"),_r_()},initEvents:function(){_i_("44d:67395230"),this.$replace.click(this.onReplaceClick.bind(this)),this.$input.keydown(this.onInputChange.bind(this)),this.$submit.click(this.callSubmit.bind(this,o.SET_ACTIVE_REWARD_COMMAND)),this.$msgList.on("click",this.REWARD_REMOVE_LINK_SELECTOR,this.callSubmit.bind(this,o.CLEAR_ACTIVE_REWARD_COMMAND)),this.$msgList.on("click",this.REWARD_MORE_INFO_LINK_SELECTOR,this.trackMoreInfoClick.bind(this)),"www"===B.env.b_site_type&&this.$msgList.on("hover",this.REWARD_MORE_INFO_LINK_SELECTOR,this.trackMoreInfoHover.bind(this)),this.callSubmit(o.GET_ACTIVE_REWARD_COMMAND),_r_()},onReplaceClick:function(){_i_("44d:ecef498a"),this.trackReplaceCouponClick(),this.$replace.hasClass("-open")?(this.$replace.removeClass("-open"),this.$form.addClass(this.HIDE_CLASS)):(this.$replace.addClass("-open"),this.$form.removeClass(this.HIDE_CLASS),this.$input.focus(),this.trackReplaceCoupon()),_r_()},setActiveRewardUI:function(){},setNoActiveRewardUI:function(){},setInitialState:function(){},getCurrentPayNowStatus:function(){},onInputChange:function(e){if(_i_("44d:81427943"),B.env.fe_email_for_coupons&&this.isFirstKeyStroke&&e.which&&("mdot"===B.env.b_site_type?t.stage("fDeYAebISHcMdSNAPcePOdVNeJMET",3):t.stage("fDeYAebISHcMdSNAPcePOdVNeJMET",2),this.isFirstKeyStroke=!1),13===e.which)return this.callSubmit(o.SET_ACTIVE_REWARD_COMMAND),_r_(!1);this.resetForm(),_r_()},resetForm:function(){_i_("44d:e583f705"),this.$error.empty(),this.$form.removeClass(this.COUPON_INVALID_CLASS),_r_()},onLoadingStart:function(){_i_("44d:1874d17e"),this.$submit.addClass(this.BUTTON_IS_LOADING_CLASS),this.$submit.attr("disabled","disabled"),this.$input.attr("disabled","disabled"),_r_()},onLoadingFinish:function(){_i_("44d:8b709a50"),this.$submit.removeClass(this.BUTTON_IS_LOADING_CLASS),this.$submit.removeAttr("disabled"),this.$input.removeAttr("disabled"),_r_()},_getCommand:function(){_i_("44d:5b36a03e"),this.initialized=!0,this.setInitialState();var e=r.getCoupon();e?(this.$input.val(e),this._setCommand()):this.onLoadingFinish(),_r_()},_clearCommand:function(){_i_("44d:1a44076a"),this.onLoadingFinish(),this.$hiddenInput.val(""),r.removeCoupon(),this.activeReward=null,this.setNoActiveRewardUI(),this.$input.focus(),_.emit(o.REWARDS_COUPON_REMOVED),this.trackRemoveCoupon(),_r_()},_setCommand:function(){_i_("44d:89a47634");var e={reward_code:this.$input.val().trim().toUpperCase(),transaction_value:B.env.fe_current_value_for_coupons-d};if(this.activeReward&&this.activeReward.rewardCode===e.reward_code)return this.$form.addClass(this.COUPON_INVALID_CLASS),this.createInvalidElem({status:"E_ALREADY_ACTIVE"}),_r_(!1);if("mdot"===B.env.b_site_type&&B.env.b_no_cc_required){var i=$("#email");if(!i||!i.val())return this.$form.addClass(this.COUPON_INVALID_CLASS),this.$input.focus(),this.createInvalidElem({status:"E_EMAIL_MISSING"}),this.onLoadingFinish(),_r_(!1);e.booker_email=i.val().trim()}o.onSubmit(o.SET_ACTIVE_REWARD_COMMAND,e,this.setCouponCallback.bind(this)),_r_()},getCouponValueFromInput:function(){return _i_("44d:a205d06a"),_r_(this.$input.val().trim().toUpperCase().replace(/\s/g,""))},callSubmit:function(e){_i_("44d:8b17cc9b");var i={};if(e===o.CLEAR_ACTIVE_REWARD_COMMAND?this.trackRemoveCouponClick():e===o.SET_ACTIVE_REWARD_COMMAND&&this.trackAddCouponClick(),e===o.SET_ACTIVE_REWARD_COMMAND&&(i.reward_code=this.getCouponValueFromInput(),this.activeReward&&this.activeReward.rewardCode===i.reward_code))return this.$form.addClass(this.COUPON_INVALID_CLASS),this.createInvalidElem({status:"E_ALREADY_ACTIVE"}),_r_(!1);e!==o.SET_ACTIVE_REWARD_COMMAND&&e!==o.GET_ACTIVE_REWARD_COMMAND||(i.transaction_value=B.env.fe_current_value_for_coupons-d),this.resetForm(),this.onLoadingStart(),e===o.GET_ACTIVE_REWARD_COMMAND&&r.getCoupon()?o.onSubmit(e,i,this.validateResult.bind(this)):e===o.CLEAR_ACTIVE_REWARD_COMMAND&&this.activeReward&&!this.activeReward._isDeprecated?this._clearCommand():e===o.SET_ACTIVE_REWARD_COMMAND&&o.useNewFlow(i.reward_code)?this._setCommand():o.onSubmit(e,i,this.validateResult.bind(this)),_r_()},setCouponCallback:function(e){if(_i_("44d:32766acc"),this.onLoadingFinish(),e&&e.valid){this.activeReward&&this.activeReward._isDeprecated&&o.onSubmit(o.CLEAR_ACTIVE_REWARD_COMMAND,{},function(e,i){});var i=this.getCouponValueFromInput();this.$input.val(""),this.setActiveRewardUI(),this.createCouponCard(e),window.BUI&&window.BUI.initComponents&&window.BUI.initComponents(this.$msgList.get(0)),_.emit(o.REWARDS_COUPON_ADDED),this.trackAddCoupon(),this.setActiveCouponData(i),this.$hiddenInput.val(i),r.setCoupon(i),this.publishInstantDiscountChanged()}else this.$hiddenInput.val(""),r.removeCoupon(),this.$form.addClass(this.COUPON_INVALID_CLASS),this.$input.focus(),_.emit(o.REWARDS_COUPON_INVALID),this.initialized&&(e&&e.error_messages?this.createInvalidElem({reasons:e.error_messages}):this.createInvalidElem({status:"E_NETWORK_ERROR"}));this.initialized=!0,_r_()},validateResult:function(e,i,a){if(_i_("44d:de5ca85a"),this.onLoadingFinish(),e&&e.success)i===o.SET_ACTIVE_REWARD_COMMAND&&this.$input.val(""),e.message?(this.setActiveRewardUI(),this.createValidElem(e.message),window.BUI&&window.BUI.initComponents&&window.BUI.initComponents(this.$msgList.get(0)),_.emit(o.REWARDS_COUPON_ADDED),this.$hiddenInput.val(""),r.removeCoupon(),this.trackAddCoupon(),1<=t.track("fDeYAefMTeRSBJbKYaDFTDSJC")&&t.stage("fDeYAefMTeRSBJbKYaDFTDSJC",1)):i===o.CLEAR_ACTIVE_REWARD_COMMAND?(this.setNoActiveRewardUI(),this.$input.focus(),_.emit(o.REWARDS_COUPON_REMOVED),this.trackRemoveCoupon()):this.setInitialState(),this.setActiveRewardData(e.message),this.handlePayOnlineChanged(this.getCurrentPayNowStatus()),this.publishInstantDiscountChanged();else if(i===o.SET_ACTIVE_REWARD_COMMAND&&(this.$form.addClass(this.COUPON_INVALID_CLASS),this.$input.focus(),_.emit(o.REWARDS_COUPON_INVALID)),this.initialized){var n=e&&e.message?e.message:{status:"E_NETWORK_ERROR"};this.createInvalidElem(n)}this.initialized=!0,_r_()},createInvalidElem:function(e){_i_("44d:7a767342"),this.$error.html(B.jstmpl("reward_invalid_message").render({reward_error:e})),_r_()},createValidElem:function(e){_i_("44d:6407f02e");var i=B.env.b_nonsecure_hostname?B.env.b_nonsecure_hostname:B.env.nonsecure_hostname,a=i+"/content/referral-terms"+B.env.b_query_params_with_lang+";is_incentive=1",n=i+"/content/incentives-faq"+B.env.b_query_params_with_lang;this.$msgList.append(B.jstmpl("promo_card").render({reward_item:e,terms_url:a,faq_url:n})),_r_()},createCouponCard:function(e){_i_("44d:5fa114ce"),this.$msgList.append(B.jstmpl("coupon_card").render({reward_data:e})),_r_()},setActiveCouponData:function(e){_i_("44d:d8bd00cf"),this.activeReward={rewardCode:e},_r_()},setActiveRewardData:function(e){_i_("44d:4f66404d"),e&&e.data?(this.activeReward={_isDeprecated:!0,rewardCode:e.data.b_reward_code,rewardPayNow:e.data.b_reward_types.pay_now,rewardPayLater:e.data.b_reward_types.pay_later,isValid:"VALID"===e.status},t.customGoal("fDeYAeaDUGTVZMYCXMXFUNYcHaDEUZC",4),t.customGoal("fDeYAeaDUGTVZMYCBJbCMALFIVZOFHe",4),t.customGoal("fDeYAeaDUGTMJRUKcbXDOXJKDKaT",4),t.customGoal("fDeYAeaDUGTMbYRabbHVJNLDOeHbC",4),t.customGoal("fDeYAeaDUGTBEUWHJEeeKET",4)):this.activeReward=null,_r_()},getActiveRewardData:function(){return _i_("44d:098a5e24"),_r_(this.activeReward)},handleDiscountChange:function(e){_i_("44d:108df9f1"),d!==e.user_total_discount&&(d=e.user_total_discount,this.callSubmit(o.GET_ACTIVE_REWARD_COMMAND)),_r_()},handlePayOnlineChanged:function(e){_i_("44d:4923850f");var i=this.getActiveRewardData();if(i){var a=this.$el.find(this.REWARD_CARD_SELECTOR).first();!i.isValid||e&&!i.rewardPayNow||!e&&!i.rewardPayLater?a.addClass("-error"):a.removeClass("-error")}_r_()},publishInstantDiscountChanged:function(){_i_("44d:276ac07a");var e=this.getActiveRewardData();e&&e.isValid&&"instant-discount"===e.rewardPayNow&&_.emit(o.INSTANT_DISCOUNT_EVENT_CHANGED,{campaign_id:512574,campaign_data:e}),_r_()},trackMoreInfoClick:function(){_i_("44d:5db2b2c8"),s.trackEvent("AOB-more-info-click"),_r_()},trackMoreInfoHover:function(){_i_("44d:9fe6d6f0"),s.trackEvent("AOB-more-info-hover"),_r_()},trackAddCouponClick:function(){_i_("44d:e89fcb12"),s.trackEvent("AOB-apply-click"),_r_()},trackRemoveCouponClick:function(){_i_("44d:3e20d091"),s.trackEvent("AOB-remove-click"),_r_()},trackReplaceCouponClick:function(){_i_("44d:b2cf030e"),s.trackEvent("AOB-replace-click"),_r_()},trackAddCoupon:function(){_i_("44d:71b792ca"),s.trackEvent("AOB-apply-success"),_r_()},trackRemoveCoupon:function(){_i_("44d:eea1a4c4"),s.trackEvent("AOB-remove-success"),_r_()},trackReplaceCoupon:function(){_i_("44d:73a63ff1"),s.trackEvent("AOB-replace-success"),_r_()}}),_r_()}),B.define("component/rewards-ui/promo-code",function(e,i,a){_i_("44d:92031976");var n,t=e("et"),_=e("component/rewards-ui/promo-code-base"),r=e("events"),o=e("report-error"),s=e("payment-online");try{n=e("bp/store")}catch(e){o("Error loading store: ",e)}a.exports=_.extend({init:function(){_i_("44d:084d15da"),_.prototype.init.apply(this),this.$loader=this.$el.find(".js-promo-code-loader"),this.$add=this.$el.find(".js-promo-code-add"),this.initEvents(),_r_()},initEvents:function(){_i_("44d:c0d26a3f"),_.prototype.initEvents.apply(this),this.$add.click(this.onAddClick.bind(this)),n?n.subscribe(function(){_i_("44d:779d2969");var e=n.getState();if(!e)return _r_();var i=e.payment_timing;this.handlePayOnlineChanged(i&&"now"===i.type),_r_()}.bind(this)):r.on("payment:pay_online:changed",this.handlePayOnlineChanged.bind(this)),2===t.track("fDeYAefMTeRSBJbKYaDFTDSJC")&&r.on("campaign::discounts::changed",this.handleDiscountChange.bind(this)),_r_()},onAddClick:function(){_i_("44d:02b00d7f"),this.$add.addClass(this.HIDE_CLASS),this.$form.removeClass(this.HIDE_CLASS),this.$input.focus(),_r_()},setNoActiveRewardUI:function(){_i_("44d:4c50e43e"),this.$title.html(B.jstmpl.translations("www_promo_code_entry_point_home")),this.$loader.addClass(this.HIDE_CLASS),this.$msgList.empty().addClass(this.HIDE_CLASS),this.$add.addClass(this.HIDE_CLASS),this.$replace.addClass(this.HIDE_CLASS),this.$form.removeClass(this.HIDE_CLASS),this.$submitText.html(B.jstmpl.translations("growth_marketing_fake_promo_code_cta")),_r_()},setActiveRewardUI:function(){_i_("44d:231f7920"),this.$title.html(B.jstmpl.translations("www_promo_code_bs3_list_title")),this.$loader.addClass(this.HIDE_CLASS),this.$msgList.empty().removeClass(this.HIDE_CLASS),this.$add.addClass(this.HIDE_CLASS),this.$replace.removeClass(this.HIDE_CLASS).removeClass("-open"),this.$form.addClass(this.HIDE_CLASS),this.$submitText.html(B.jstmpl.translations("www_promo_code_bs3_field_cta_different_replace")),_r_()},setInitialState:function(){_i_("44d:fe934881"),this.$loader.addClass(this.HIDE_CLASS),this.$form.removeClass(this.HIDE_CLASS),_r_()},getCurrentPayNowStatus:function(){if(_i_("44d:fe90e46d"),n&&"function"==typeof n.getState){var e=n.getState();if(!e)return _r_();var i=e.payment_timing;return _r_(i&&"now"===i.type)}var a=s.getInstance();if(a)return _r_(a.get_current_status());_r_()}}),_r_()}),B.define("component/rewards-ui/feedback-modal",function(e,i,a){_i_("44d:54ab697b");var n=e("component"),t=window.BUI;a.exports=n.extend({init:function(){_i_("44d:147fd111");var e=t.createInstance("Modal",null,{id:"incentives-feedback-modal"});e.mount(),e.open(),_r_()}}),_r_()});